(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{700:function(e,s,t){"use strict";t.r(s);var a=t(4),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"ä¸€ã€centos7-å‡çº§å†…æ ¸ç‰ˆæœ¬"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€centos7-å‡çº§å†…æ ¸ç‰ˆæœ¬"}},[e._v("#")]),e._v(" ä¸€ã€Centos7 å‡çº§å†…æ ¸ç‰ˆæœ¬")]),e._v(" "),t("h3",{attrs:{id:"_1-1-æŸ¥çœ‹å½“å‰å†…æ ¸ç‰ˆæœ¬"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-æŸ¥çœ‹å½“å‰å†…æ ¸ç‰ˆæœ¬"}},[e._v("#")]),e._v(" 1.1 æŸ¥çœ‹å½“å‰å†…æ ¸ç‰ˆæœ¬")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("uname")]),e._v(" -r\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#3.10.0-514.el7.x86_64")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("uname")]),e._v(" -a\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#Linux k8s-leader 3.10.0-514.el7.x86_64 #1 SMP Tue Nov 22 16:42:41 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" /etc/redhat-release \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#CentOS Linux release 7.3.1611 (Core) ")]),e._v("\n")])])]),t("h3",{attrs:{id:"_1-2-å‡çº§å†…æ ¸"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-å‡çº§å†…æ ¸"}},[e._v("#")]),e._v(" 1.2 å‡çº§å†…æ ¸")]),e._v(" "),t("p",[e._v("æ›´æ–°yumæºä»“åº“")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("yum -y update\n")])])]),t("p",[e._v("å¯ç”¨ ELRepo ä»“åº“\nELRepo ä»“åº“æ˜¯åŸºäºç¤¾åŒºçš„ç”¨äºä¼ä¸šçº§ Linux ä»“åº“ï¼Œæä¾›å¯¹ RedHat Enterprise (RHEL) å’Œ å…¶ä»–åŸºäº RHELçš„ Linux å‘è¡Œç‰ˆï¼ˆCentOSã€Scientificã€Fedora ç­‰ï¼‰çš„æ”¯æŒã€‚\nELRepo èšç„¦äºå’Œç¡¬ä»¶ç›¸å…³çš„è½¯ä»¶åŒ…ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ã€æ˜¾å¡é©±åŠ¨ã€ç½‘ç»œé©±åŠ¨ã€å£°å¡é©±åŠ¨å’Œæ‘„åƒå¤´é©±åŠ¨ç­‰ã€‚")]),e._v(" "),t("p",[e._v("#å¯¼å…¥ELRepoä»“åº“çš„å…¬å…±å¯†é’¥")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("rpm")]),e._v(" --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#å®‰è£…ELRepoä»“åº“çš„yumæº")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("rpm")]),e._v(" -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm\n")])])]),t("h3",{attrs:{id:"_1-3-æŸ¥çœ‹å¯ç”¨çš„ç³»ç»Ÿå†…æ ¸åŒ…"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-æŸ¥çœ‹å¯ç”¨çš„ç³»ç»Ÿå†…æ ¸åŒ…"}},[e._v("#")]),e._v(" 1.3 æŸ¥çœ‹å¯ç”¨çš„ç³»ç»Ÿå†…æ ¸åŒ…")]),e._v(" "),t("p",[e._v("å¯ä»¥çœ‹åˆ°4.4å’Œ4.18ä¸¤ä¸ªç‰ˆæœ¬")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("yum --disablerepo"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"*"')]),e._v(" --enablerepo"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"elrepo-kernel"')]),e._v(" list available\nLoaded plugins: fastestmirror\nLoading mirror speeds from cached hostfile\n * elrepo-kernel: mirrors.tuna.tsinghua.edu.cn\nelrepo-kernel                                                                                                                                                                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2.9")]),e._v(" kB  00:00:00     \nelrepo-kernel/primary_db                                                                                                                                                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.8")]),e._v(" MB  00:00:03     \nAvailable Packages\nelrepo-release.noarch                                   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("7.0")]),e._v("-5.el7.elrepo                           elrepo-kernel\nkernel-lt.x86_64                                        "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.4")]),e._v(".233-1.el7.elrepo                       elrepo-kernel\nkernel-lt-devel.x86_64                                  "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.4")]),e._v(".233-1.el7.elrepo                       elrepo-kernel\nkernel-lt-doc.noarch                                    "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.4")]),e._v(".233-1.el7.elrepo                       elrepo-kernel\nkernel-lt-headers.x86_64                                "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.4")]),e._v(".233-1.el7.elrepo                       elrepo-kernel\nkernel-lt-tools.x86_64                                  "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.4")]),e._v(".233-1.el7.elrepo                       elrepo-kernel\nkernel-lt-tools-libs.x86_64                             "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.4")]),e._v(".233-1.el7.elrepo                       elrepo-kernel\nkernel-lt-tools-libs-devel.x86_64                       "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.4")]),e._v(".233-1.el7.elrepo                       elrepo-kernel\nkernel-ml.x86_64                                        "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo                         elrepo-kernel\nkernel-ml-devel.x86_64                                  "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo                         elrepo-kernel\nkernel-ml-doc.noarch                                    "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo                         elrepo-kernel\nkernel-ml-headers.x86_64                                "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo                         elrepo-kernel\nkernel-ml-tools.x86_64                                  "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo                         elrepo-kernel\nkernel-ml-tools-libs.x86_64                             "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo                         elrepo-kernel\nkernel-ml-tools-libs-devel.x86_64                       "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo                         elrepo-kernel\nperf.x86_64                                             "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo                         elrepo-kernel\npython-perf.x86_64                                      "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo                         elrepo-kernel\n")])])]),t("h3",{attrs:{id:"_1-4-å®‰è£…æœ€æ–°ç‰ˆæœ¬å†…æ ¸"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-å®‰è£…æœ€æ–°ç‰ˆæœ¬å†…æ ¸"}},[e._v("#")]),e._v(" 1.4 å®‰è£…æœ€æ–°ç‰ˆæœ¬å†…æ ¸")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("yum --enablerepo"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("elrepo-kernel "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" kernel-ml\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# --enablerepo é€‰é¡¹å¼€å¯ CentOS ç³»ç»Ÿä¸Šçš„æŒ‡å®šä»“åº“ã€‚é»˜è®¤å¼€å¯çš„æ˜¯ elrepoï¼Œè¿™é‡Œç”¨ elrepo-kernel æ›¿æ¢ã€‚")]),e._v("\n")])])]),t("h3",{attrs:{id:"_1-5-è®¾ç½®-grub2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-è®¾ç½®-grub2"}},[e._v("#")]),e._v(" 1.5 è®¾ç½® grub2")]),e._v(" "),t("p",[e._v("å†…æ ¸å®‰è£…å¥½åï¼Œéœ€è¦è®¾ç½®ä¸ºé»˜è®¤å¯åŠ¨é€‰é¡¹å¹¶é‡å¯åæ‰ä¼šç”Ÿæ•ˆ")]),e._v(" "),t("p",[e._v("æŸ¥çœ‹ç³»ç»Ÿä¸Šçš„æ‰€æœ‰å¯ç”¨å†…æ ¸ï¼š")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("awk")]),e._v(" -F"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("' "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('\'$1=="menuentry " {print i++ " : " $2}\'')]),e._v(" /etc/grub2.cfg\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#0 : CentOS Linux (4.18.7-1.el7.elrepo.x86_64) 7 (Core)")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#1 : CentOS Linux (3.10.0-862.11.6.el7.x86_64) 7 (Core)")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#2 : CentOS Linux (3.10.0-514.el7.x86_64) 7 (Core)")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#3 : CentOS Linux (0-rescue-063ec330caa04d4baae54c6902c62e54) 7 (Core)")]),e._v("\n")])])]),t("p",[e._v("è®¾ç½®æ–°çš„å†…æ ¸ä¸ºgrub2çš„é»˜è®¤ç‰ˆæœ¬\næœåŠ¡å™¨ä¸Šå­˜åœ¨4 ä¸ªå†…æ ¸ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ 4.18 è¿™ä¸ªç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡ grub2-set-default 0 å‘½ä»¤æˆ–ç¼–è¾‘ /etc/default/grub æ–‡ä»¶æ¥è®¾ç½®")]),e._v(" "),t("h4",{attrs:{id:"æ–¹æ³•1ã€é€šè¿‡-grub2-set-default-0-å‘½ä»¤è®¾ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ³•1ã€é€šè¿‡-grub2-set-default-0-å‘½ä»¤è®¾ç½®"}},[e._v("#")]),e._v(" æ–¹æ³•1ã€é€šè¿‡ grub2-set-default 0 å‘½ä»¤è®¾ç½®")]),e._v(" "),t("p",[e._v("å…¶ä¸­ 0 æ˜¯ä¸Šé¢æŸ¥è¯¢å‡ºæ¥çš„å¯ç”¨å†…æ ¸")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("grub2-set-default "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n")])])]),t("h4",{attrs:{id:"æ–¹æ³•2ã€ç¼–è¾‘-etc-default-grub-æ–‡ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ³•2ã€ç¼–è¾‘-etc-default-grub-æ–‡ä»¶"}},[e._v("#")]),e._v(" æ–¹æ³•2ã€ç¼–è¾‘ /etc/default/grub æ–‡ä»¶")]),e._v(" "),t("p",[e._v("è®¾ç½® GRUB_DEFAULT=0ï¼Œé€šè¿‡ä¸Šé¢æŸ¥è¯¢æ˜¾ç¤ºçš„ç¼–å·ä¸º 0 çš„å†…æ ¸ä½œä¸ºé»˜è®¤å†…æ ¸ï¼š")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("vim")]),e._v(" /etc/default/grub\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GRUB_TIMEOUT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GRUB_DISTRIBUTOR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'s, release .*$,,g'")]),e._v(" /etc/system-release"),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v('"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GRUB_DEFAULT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GRUB_DISABLE_SUBMENU")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GRUB_TERMINAL_OUTPUT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"console"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GRUB_CMDLINE_LINUX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"crashkernel=auto rd.lvm.lv=cl/root rhgb quiet"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GRUB_DISABLE_RECOVERY")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"true"')]),e._v("\n")])])]),t("p",[e._v("ç”Ÿæˆ grub é…ç½®æ–‡ä»¶å¹¶é‡å¯")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("grub2-mkconfig -o /boot/grub2/grub.cfg\nGenerating grub configuration "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("file")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nFound linux image: /boot/vmlinuz-4.18.7-1.el7.elrepo.x86_64\nFound initrd image: /boot/initramfs-4.18.7-1.el7.elrepo.x86_64.img\nFound linux image: /boot/vmlinuz-3.10.0-862.11.6.el7.x86_64\nFound initrd image: /boot/initramfs-3.10.0-862.11.6.el7.x86_64.img\nFound linux image: /boot/vmlinuz-3.10.0-514.el7.x86_64\nFound initrd image: /boot/initramfs-3.10.0-514.el7.x86_64.img\nFound linux image: /boot/vmlinuz-0-rescue-063ec330caa04d4baae54c6902c62e54\nFound initrd image: /boot/initramfs-0-rescue-063ec330caa04d4baae54c6902c62e54.img\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("done")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("reboot")]),e._v("\n")])])]),t("h3",{attrs:{id:"_1-6-éªŒè¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-éªŒè¯"}},[e._v("#")]),e._v(" 1.6 éªŒè¯")]),e._v(" "),t("p",[e._v("rebootåéªŒè¯")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("uname")]),e._v(" -r\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#4.18.7-1.el7.elrepo.x86_64")]),e._v("\n")])])]),t("h3",{attrs:{id:"_1-7-åˆ é™¤æ—§å†…æ ¸ï¼ˆå¯é€‰ï¼‰"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-7-åˆ é™¤æ—§å†…æ ¸ï¼ˆå¯é€‰ï¼‰"}},[e._v("#")]),e._v(" 1.7 åˆ é™¤æ—§å†…æ ¸ï¼ˆå¯é€‰ï¼‰")]),e._v(" "),t("p",[e._v("æŸ¥çœ‹ç³»ç»Ÿä¸­å…¨éƒ¨çš„å†…æ ¸ï¼š")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("rpm")]),e._v(" -qa "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("grep")]),e._v(" kernel\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#kernel-3.10.0-514.el7.x86_64")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#kernel-ml-4.18.7-1.el7.elrepo.x86_64")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#kernel-tools-libs-3.10.0-862.11.6.el7.x86_64")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#kernel-tools-3.10.0-862.11.6.el7.x86_64")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#kernel-3.10.0-862.11.6.el7.x86_64")]),e._v("\n")])])]),t("h4",{attrs:{id:"æ–¹æ³•1ã€yum-remove-åˆ é™¤æ—§å†…æ ¸çš„-rpm-åŒ…"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ³•1ã€yum-remove-åˆ é™¤æ—§å†…æ ¸çš„-rpm-åŒ…"}},[e._v("#")]),e._v(" æ–¹æ³•1ã€yum remove åˆ é™¤æ—§å†…æ ¸çš„ RPM åŒ…")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("yum remove kernel-3.10.0-514.el7.x86_64 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\nkernel-tools-libs-3.10.0-862.11.6.el7.x86_64 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\nkernel-tools-3.10.0-862.11.6.el7.x86_64 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\nkernel-3.10.0-862.11.6.el7.x86_64\n")])])]),t("h4",{attrs:{id:"æ–¹æ³•2ã€yum-utils-å·¥å…·"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ³•2ã€yum-utils-å·¥å…·"}},[e._v("#")]),e._v(" æ–¹æ³•2ã€yum-utils å·¥å…·")]),e._v(" "),t("p",[e._v("å¦‚æœå®‰è£…çš„å†…æ ¸ä¸å¤šäº 3 ä¸ªï¼Œyum-utils å·¥å…·ä¸ä¼šåˆ é™¤ä»»ä½•ä¸€ä¸ªã€‚åªæœ‰åœ¨å®‰è£…çš„å†…æ ¸å¤§äº 3 ä¸ªæ—¶ï¼Œæ‰ä¼šè‡ªåŠ¨åˆ é™¤æ—§å†…æ ¸ã€‚")]),e._v(" "),t("p",[e._v("å®‰è£…yum-utils")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" yum-utils\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#åˆ é™¤æ—§ç‰ˆæœ¬ã€€ã€€")]),e._v("\npackage-cleanup --oldkernels\n")])])]),t("h2",{attrs:{id:"äºŒã€å®‰è£…-kubernetes-é›†ç¾¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€å®‰è£…-kubernetes-é›†ç¾¤"}},[e._v("#")]),e._v(" äºŒã€å®‰è£… Kubernetes é›†ç¾¤")]),e._v(" "),t("h3",{attrs:{id:"_2-1-æ£€æŸ¥-centos-hostname"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-æ£€æŸ¥-centos-hostname"}},[e._v("#")]),e._v(" 2.1 æ£€æŸ¥ centos / hostname")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" /etc/redhat-release\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æ­¤å¤„ hostname çš„è¾“å‡ºå°†ä¼šæ˜¯è¯¥æœºå™¨åœ¨ Kubernetes é›†ç¾¤ä¸­çš„èŠ‚ç‚¹åå­—")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ä¸èƒ½ä½¿ç”¨ localhost ä½œä¸ºèŠ‚ç‚¹çš„åå­—")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("hostname")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# è¯·ä½¿ç”¨ lscpu å‘½ä»¤ï¼Œæ ¸å¯¹ CPU ä¿¡æ¯")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Architecture: x86_64    æœ¬å®‰è£…æ–‡æ¡£ä¸æ”¯æŒ arm æ¶æ„")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# CPU(s):       2         CPU å†…æ ¸æ•°é‡ä¸èƒ½ä½äº 2")]),e._v("\nlscpu\n")])])]),t("h4",{attrs:{id:"_2-1-1-æ“ä½œç³»ç»Ÿå…¼å®¹æ€§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-æ“ä½œç³»ç»Ÿå…¼å®¹æ€§"}},[e._v("#")]),e._v(" 2.1.1 æ“ä½œç³»ç»Ÿå…¼å®¹æ€§")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("CentOS ç‰ˆæœ¬")]),e._v(" "),t("th",[e._v("æœ¬æ–‡æ¡£æ˜¯å¦å…¼å®¹")]),e._v(" "),t("th",[e._v("å¤‡æ³¨")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("7.8")]),e._v(" "),t("td",[e._v("ğŸ˜„")]),e._v(" "),t("td",[e._v("å·²éªŒè¯")])]),e._v(" "),t("tr",[t("td",[e._v("7.7")]),e._v(" "),t("td",[e._v("ğŸ˜„")]),e._v(" "),t("td",[e._v("å·²éªŒè¯")])]),e._v(" "),t("tr",[t("td",[e._v("7.6")]),e._v(" "),t("td",[e._v("ğŸ˜„")]),e._v(" "),t("td",[e._v("å·²éªŒè¯")])]),e._v(" "),t("tr",[t("td",[e._v("7.5")]),e._v(" "),t("td",[e._v("ğŸ˜")]),e._v(" "),t("td",[e._v("å·²è¯å®ä¼šå‡ºç° kubelet æ— æ³•å¯åŠ¨çš„é—®é¢˜")])]),e._v(" "),t("tr",[t("td",[e._v("7.4")]),e._v(" "),t("td",[e._v("ğŸ˜")]),e._v(" "),t("td",[e._v("å·²è¯å®ä¼šå‡ºç° kubelet æ— æ³•å¯åŠ¨çš„é—®é¢˜")])]),e._v(" "),t("tr",[t("td",[e._v("7.3")]),e._v(" "),t("td",[e._v("ğŸ˜")]),e._v(" "),t("td",[e._v("å·²è¯å®ä¼šå‡ºç° kubelet æ— æ³•å¯åŠ¨çš„é—®é¢˜")])]),e._v(" "),t("tr",[t("td",[e._v("7.2")]),e._v(" "),t("td",[e._v("ğŸ˜")]),e._v(" "),t("td",[e._v("å·²è¯å®ä¼šå‡ºç° kubelet æ— æ³•å¯åŠ¨çš„é—®é¢˜")])])])]),e._v(" "),t("h4",{attrs:{id:"_2-1-2-ä¿®æ”¹-hostname"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-2-ä¿®æ”¹-hostname"}},[e._v("#")]),e._v(" 2.1.2 ä¿®æ”¹ hostname")]),e._v(" "),t("p",[e._v("å¦‚æœæ‚¨éœ€è¦ä¿®æ”¹ hostnameï¼Œå¯æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ä¿®æ”¹ hostname")]),e._v("\nhostnamectl set-hostname your-new-host-name\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æŸ¥çœ‹ä¿®æ”¹ç»“æœ")]),e._v("\nhostnamectl status\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# è®¾ç½® hostname è§£æ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"127.0.0.1   '),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("hostname")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v('"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/hosts\n")])])]),t("h4",{attrs:{id:"_2-1-3-æ£€æŸ¥ç½‘ç»œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-æ£€æŸ¥ç½‘ç»œ"}},[e._v("#")]),e._v(" 2.1.3 æ£€æŸ¥ç½‘ç»œ")]),e._v(" "),t("p",[e._v("åœ¨æ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œå‘½ä»¤")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("root@k8s-leader ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("ip")]),e._v(" route show\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#default via 192.168.83.1 dev ens33 proto static metric 100 ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1 linkdown ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#192.168.83.0/24 dev ens33 proto kernel scope link src 192.168.83.11 metric 100 ")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("root@k8s-leader ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("ip")]),e._v(" address\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#    inet 127.0.0.1/8 scope host lo")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#       valid_lft forever preferred_lft forever")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#    inet6 ::1/128 scope host ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#       valid_lft forever preferred_lft forever")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#    link/ether 00:0c:29:da:6c:65 brd ff:ff:ff:ff:ff:ff")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#    inet 192.168.83.11/24 brd 192.168.83.255 scope global noprefixroute ens33")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#       valid_lft forever preferred_lft forever")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#    inet6 fe80::2402:dfd2:eab2:573/64 scope link noprefixroute ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#       valid_lft forever preferred_lft forever")]),e._v("\n\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("kubeletä½¿ç”¨çš„IPåœ°å€")]),e._v(" "),t("p",[t("code",[e._v("ip route show")]),e._v("å‘½ä»¤ä¸­ï¼Œå¯ä»¥çŸ¥é“æœºå™¨çš„é»˜è®¤ç½‘å¡ï¼Œé€šå¸¸æ˜¯ eth0ï¼Œå¦‚ default via 172.21.0.23 dev eth0 å¦‚æœvmwareç¯å¢ƒä¸‹ä¸€èˆ¬ä¸ºens33"),t("br"),e._v(" "),t("code",[e._v("ip address")]),e._v(" å‘½ä»¤ä¸­ï¼Œå¯æ˜¾ç¤ºé»˜è®¤ç½‘å¡çš„ IP åœ°å€ï¼ŒKubernetes å°†ä½¿ç”¨æ­¤ IP åœ°å€ä¸é›†ç¾¤å†…çš„å…¶ä»–èŠ‚ç‚¹é€šä¿¡ï¼Œå¦‚ 172.17.216.80"),t("br"),e._v("\næ‰€æœ‰èŠ‚ç‚¹ä¸Š Kubernetes æ‰€ä½¿ç”¨çš„ IP åœ°å€å¿…é¡»å¯ä»¥äº’é€šï¼ˆæ— éœ€ NAT æ˜ å°„ã€æ— å®‰å…¨ç»„æˆ–é˜²ç«å¢™éš”ç¦»ï¼‰")])]),e._v(" "),t("h3",{attrs:{id:"_2-2-å®‰è£…dockeråŠkubelet"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-å®‰è£…dockeråŠkubelet"}},[e._v("#")]),e._v(" 2.2 å®‰è£…dockeråŠkubelet")]),e._v(" "),t("p",[e._v("è¯·è®¤çœŸæ ¸å¯¹å¦‚ä¸‹é€‰é¡¹ï¼Œ7ä¸ªéƒ½ç¬¦åˆå†å®‰è£…ã€‚")]),e._v(" "),t("p",[e._v("ğŸ˜„ æˆ‘çš„ä»»æ„èŠ‚ç‚¹ centos ç‰ˆæœ¬ä¸º 7.6 / 7.7 æˆ– 7.8"),t("br"),e._v("\nğŸ˜„ æˆ‘çš„ä»»æ„èŠ‚ç‚¹ CPU å†…æ ¸æ•°é‡å¤§äºç­‰äº 2ï¼Œä¸”å†…å­˜å¤§äºç­‰äº 4G"),t("br"),e._v("\nğŸ˜„ æˆ‘çš„ä»»æ„èŠ‚ç‚¹ hostname ä¸æ˜¯ localhostï¼Œä¸”ä¸åŒ…å«ä¸‹åˆ’çº¿ã€å°æ•°ç‚¹ã€å¤§å†™å­—æ¯"),t("br"),e._v("\nğŸ˜„ æˆ‘çš„ä»»æ„èŠ‚ç‚¹éƒ½æœ‰å›ºå®šçš„å†…ç½‘ IP åœ°å€"),t("br"),e._v("\nğŸ˜„ æˆ‘çš„ä»»æ„èŠ‚ç‚¹éƒ½åªæœ‰ä¸€ä¸ªç½‘å¡ï¼Œå¦‚æœæœ‰ç‰¹æ®Šç›®çš„ï¼Œå¯ä»¥åœ¨å®Œæˆ K8S å®‰è£…åå†å¢åŠ æ–°çš„ç½‘å¡"),t("br"),e._v("\nğŸ˜„ æˆ‘çš„ä»»æ„èŠ‚ç‚¹ä¸Š Kubeletä½¿ç”¨çš„ IP åœ°å€ å¯äº’é€šï¼ˆæ— éœ€ NAT æ˜ å°„å³å¯ç›¸äº’è®¿é—®ï¼‰ï¼Œä¸”æ²¡æœ‰é˜²ç«å¢™ã€å®‰å…¨ç»„éš”ç¦»"),t("br"),e._v("\nğŸ˜„ æˆ‘çš„ä»»æ„èŠ‚ç‚¹ä¸ä¼šç›´æ¥ä½¿ç”¨ docker run æˆ– docker-compose è¿è¡Œå®¹å™¨")]),e._v(" "),t("h4",{attrs:{id:"_2-2-1-å¿«é€Ÿå®‰è£…ï¼ˆæ¨èï¼‰"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-å¿«é€Ÿå®‰è£…ï¼ˆæ¨èï¼‰"}},[e._v("#")]),e._v(" 2.2.1 å¿«é€Ÿå®‰è£…ï¼ˆæ¨èï¼‰")]),e._v(" "),t("p",[e._v("docker hub é•œåƒè¯·æ ¹æ®è‡ªå·±ç½‘ç»œçš„æƒ…å†µä»»é€‰ä¸€ä¸ª")]),e._v(" "),t("ul",[t("li",[e._v("ç¬¬å››è¡Œä¸ºè…¾è®¯äº‘ docker hub é•œåƒ")]),e._v(" "),t("li",[e._v("ç¬¬å…­è¡Œä¸ºDaoCloud docker hub é•œåƒ")]),e._v(" "),t("li",[e._v("ç¬¬å…«è¡Œä¸ºåä¸ºäº‘ docker hub é•œåƒ")]),e._v(" "),t("li",[e._v("ç¬¬åè¡Œä¸ºé˜¿é‡Œäº‘ docker hub é•œåƒ")])]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åœ¨ leader èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æœ€åä¸€ä¸ªå‚æ•° 1.18.6 ç”¨äºæŒ‡å®š kubenetes ç‰ˆæœ¬ï¼Œæ”¯æŒæ‰€æœ‰ 1.18.x ç‰ˆæœ¬çš„å®‰è£…")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# è…¾è®¯äº‘ docker hub é•œåƒ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# export REGISTRY_MIRROR="https://mirror.ccs.tencentyun.com"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# DaoCloud é•œåƒ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# export REGISTRY_MIRROR="http://f1361db2.m.daocloud.io"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åä¸ºäº‘é•œåƒ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# export REGISTRY_MIRROR="https://05f073ad3c0010ea0f4bc00b7105ec20.mirror.swr.myhuaweicloud.com"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# é˜¿é‡Œäº‘ docker hub é•œåƒ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# export REGISTRY_MIRROR=https://registry.cn-hangzhou.aliyuncs.com")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -sSL https://kuboard.cn/install-script/v1.18.x/install_kubelet.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sh")]),e._v(" -s "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.18")]),e._v(".8\n")])])]),t("h4",{attrs:{id:"_2-2-2-æ‰‹åŠ¨å®‰è£…"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-æ‰‹åŠ¨å®‰è£…"}},[e._v("#")]),e._v(" 2.2.2 æ‰‹åŠ¨å®‰è£…")]),e._v(" "),t("p",[e._v("docker hub é•œåƒè¯·æ ¹æ®è‡ªå·±ç½‘ç»œçš„æƒ…å†µä»»é€‰ä¸€ä¸ª")]),e._v(" "),t("ul",[t("li",[e._v("ç¬¬å››è¡Œä¸ºè…¾è®¯äº‘ docker hub é•œåƒ")]),e._v(" "),t("li",[e._v("ç¬¬å…­è¡Œä¸ºDaoCloud docker hub é•œåƒ")]),e._v(" "),t("li",[e._v("ç¬¬å…«è¡Œä¸ºé˜¿é‡Œäº‘ docker hub é•œåƒ")])]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åœ¨ leader èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æœ€åä¸€ä¸ªå‚æ•° 1.18.6 ç”¨äºæŒ‡å®š kubenetes ç‰ˆæœ¬ï¼Œæ”¯æŒæ‰€æœ‰ 1.18.x ç‰ˆæœ¬çš„å®‰è£…")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# è…¾è®¯äº‘ docker hub é•œåƒ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# export REGISTRY_MIRROR="https://mirror.ccs.tencentyun.com"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# DaoCloud é•œåƒ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# export REGISTRY_MIRROR="http://f1361db2.m.daocloud.io"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# é˜¿é‡Œäº‘ docker hub é•œåƒ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("REGISTRY_MIRROR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("https://registry.cn-hangzhou.aliyuncs.com\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[e._v("#!/bin/bash")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åœ¨ leader èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å®‰è£… docker")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å‚è€ƒæ–‡æ¡£å¦‚ä¸‹")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# https://docs.docker.com/install/linux/docker-ce/centos/ ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# https://docs.docker.com/install/linux/linux-postinstall/")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å¸è½½æ—§ç‰ˆæœ¬")]),e._v("\nyum remove -y "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndocker-client "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndocker-client-latest "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndocker-ce-cli "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndocker-common "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndocker-latest "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndocker-latest-logrotate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndocker-logrotate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndocker-selinux "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndocker-engine-selinux "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndocker-engine\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# è®¾ç½® yum repository")]),e._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y yum-utils "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\ndevice-mapper-persistent-data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\nlvm2\nyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å®‰è£…å¹¶å¯åŠ¨ docker")]),e._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y docker-ce-19.03.8 docker-ce-cli-19.03.8 containerd.io\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v("\nsystemctl start "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å®‰è£… nfs-utils")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å¿…é¡»å…ˆå®‰è£… nfs-utils æ‰èƒ½æŒ‚è½½ nfs ç½‘ç»œå­˜å‚¨")]),e._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y nfs-utils\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("wget")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å…³é—­ é˜²ç«å¢™")]),e._v("\nsystemctl stop firewalld\nsystemctl disable firewalld\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å…³é—­ SeLinux")]),e._v("\nsetenforce "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s/SELINUX=enforcing/SELINUX=disabled/g"')]),e._v(" /etc/selinux/config\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å…³é—­ swap")]),e._v("\nswapoff -a\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("yes")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cp")]),e._v(" /etc/fstab /etc/fstab_bak\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" /etc/fstab_bak "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("grep")]),e._v(" -v swap "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /etc/fstab\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ä¿®æ”¹ /etc/sysctl.conf")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å¦‚æœæœ‰é…ç½®ï¼Œåˆ™ä¿®æ”¹")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s#^net.ipv4.ip_forward.*#net.ipv4.ip_forward=1#g"')]),e._v("  /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s#^net.bridge.bridge-nf-call-ip6tables.*#net.bridge.bridge-nf-call-ip6tables=1#g"')]),e._v("  /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s#^net.bridge.bridge-nf-call-iptables.*#net.bridge.bridge-nf-call-iptables=1#g"')]),e._v("  /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s#^net.ipv6.conf.all.disable_ipv6.*#net.ipv6.conf.all.disable_ipv6=1#g"')]),e._v("  /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s#^net.ipv6.conf.default.disable_ipv6.*#net.ipv6.conf.default.disable_ipv6=1#g"')]),e._v("  /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s#^net.ipv6.conf.lo.disable_ipv6.*#net.ipv6.conf.lo.disable_ipv6=1#g"')]),e._v("  /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s#^net.ipv6.conf.all.forwarding.*#net.ipv6.conf.all.forwarding=1#g"')]),e._v("  /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å¯èƒ½æ²¡æœ‰ï¼Œè¿½åŠ ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"net.ipv4.ip_forward = 1"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"net.bridge.bridge-nf-call-ip6tables = 1"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"net.bridge.bridge-nf-call-iptables = 1"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"net.ipv6.conf.all.disable_ipv6 = 1"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"net.ipv6.conf.default.disable_ipv6 = 1"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"net.ipv6.conf.lo.disable_ipv6 = 1"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"net.ipv6.conf.all.forwarding = 1"')]),e._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æ‰§è¡Œå‘½ä»¤ä»¥åº”ç”¨")]),e._v("\nsysctl -p\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# é…ç½®K8Sçš„yumæº")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("EOF"),t("span",{pre:!0,attrs:{class:"token bash punctuation"}},[e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /etc/yum.repos.d/kubernetes.repo")]),e._v("\n[kubernetes]\nname=Kubernetes\nbaseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64\nenabled=1\ngpgcheck=0\nrepo_gpgcheck=0\ngpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg\n       http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\nEOF")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å¸è½½æ—§ç‰ˆæœ¬")]),e._v("\nyum remove -y kubelet kubeadm kubectl\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å®‰è£…kubeletã€kubeadmã€kubectl")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å°† ${1} æ›¿æ¢ä¸º kubernetes ç‰ˆæœ¬å·ï¼Œä¾‹å¦‚ 1.17.2")]),e._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y kubelet-"),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${1}")]),e._v(" kubeadm-"),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${1}")]),e._v(" kubectl-"),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${1}")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ä¿®æ”¹docker Cgroup Driverä¸ºsystemd")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# # å°†/usr/lib/systemd/system/docker.serviceæ–‡ä»¶ä¸­çš„è¿™ä¸€è¡Œ ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# # ä¿®æ”¹ä¸º ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemd")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å¦‚æœä¸ä¿®æ”¹ï¼Œåœ¨æ·»åŠ  worker èŠ‚ç‚¹æ—¶å¯èƒ½ä¼šç¢°åˆ°å¦‚ä¸‹é”™è¯¯")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# [WARNING IsDockerSystemdCheck]: detected "cgroupfs" as the Docker cgroup driver. The recommended driver is "systemd". ')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Please follow the guide at https://kubernetes.io/docs/setup/cri/")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s#^ExecStart=/usr/bin/dockerd.*#ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemd#g"')]),e._v(" /usr/lib/systemd/system/docker.service\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# è®¾ç½® docker é•œåƒï¼Œæé«˜ docker é•œåƒä¸‹è½½é€Ÿåº¦å’Œç¨³å®šæ€§")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å¦‚æœæ‚¨è®¿é—® https://hub.docker.io é€Ÿåº¦éå¸¸ç¨³å®šï¼Œäº¦å¯ä»¥è·³è¿‡è¿™ä¸ªæ­¥éª¤")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -sSL https://kuboard.cn/install-script/set_mirror.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sh")]),e._v(" -s "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${REGISTRY_MIRROR}")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# é‡å¯ dockerï¼Œå¹¶å¯åŠ¨ kubelet")]),e._v("\nsystemctl daemon-reload\nsystemctl restart "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v("\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v(" kubelet "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" systemctl start kubelet\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" version\n")])])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("æ³¨æ„")]),e._v(" "),t("p",[e._v("å¦‚æœæ­¤æ—¶æ‰§è¡Œ service status kubelet å‘½ä»¤ï¼Œå°†å¾—åˆ° kubelet å¯åŠ¨å¤±è´¥çš„é”™è¯¯æç¤ºï¼Œè¯·å¿½ç•¥æ­¤é”™è¯¯ï¼Œå› ä¸ºå¿…é¡»å®Œæˆåç»­æ­¥éª¤ä¸­ kubeadm init çš„æ“ä½œï¼Œkubelet æ‰èƒ½æ­£å¸¸å¯åŠ¨")])]),e._v(" "),t("p",[e._v("éªŒè¯")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("--------è¯·æ£€æŸ¥ä¸‹é¢è¾“å‡ºç»“æœä¸­çš„ Registry Mirrors æ˜¯å¦å·²ç»ä¿®æ”¹è¿‡æ¥-------- \n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" info\nClient:\n Debug Mode: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n\nServer:\n Containers: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n  Running: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n  Paused: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n  Stopped: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n Images: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n Server Version: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("19.03")]),e._v(".8\n Storage Driver: overlay2\n  Backing Filesystem: "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("unknown"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n  Supports d_type: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\n  Native Overlay Diff: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\n Logging Driver: json-file\n Cgroup Driver: systemd\n Plugins:\n  Volume: "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("local")]),e._v("\n  Network: bridge "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("host")]),e._v(" ipvlan macvlan null overlay\n  Log: awslogs fluentd gcplogs gelf journald json-file "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("local")]),e._v(" logentries splunk syslog\n Swarm: inactive\n Runtimes: runc\n Default Runtime: runc\n Init Binary: docker-init\n containerd version: 7ad184331fa3e55e52b890ea95e65ba581ae3429\n runc version: dc9208a3303feef5b3839f4323d9beb36df0a9dd\n init version: fec3683\n Security Options:\n  seccomp\n   Profile: default\n Kernel Version: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo.x86_64\n Operating System: CentOS Linux "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("7")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("Core"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n OSType: linux\n Architecture: x86_64\n CPUs: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("\n Total Memory: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(".915GiB\n Name: k8s-leader\n ID: 2PXC:YUNB:G5YK:ZZWD:SLGB:FAXI:AZES:OP2W:IMYD:UCBW:EEO3:75Z2\n Docker Root Dir: /var/lib/docker\n Debug Mode: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n Registry: https://index.docker.io/v1/\n Labels:\n Experimental: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n Insecure Registries:\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("127.0")]),e._v(".0.0/8\n Registry Mirrors:\n  https://registry.cn-hangzhou.aliyuncs.com/\n Live Restore Enabled: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n\nCreated symlink from /etc/systemd/system/multi-user.target.wants/kubelet.service to /usr/lib/systemd/system/kubelet.service.\nClient: Docker Engine - Community\n Version:           "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("19.03")]),e._v(".8\n API version:       "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.40")]),e._v("\n Go version:        go1.12.17\n Git commit:        afacb8b\n Built:             Wed Mar "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("11")]),e._v(" 01:27:04 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2020")]),e._v("\n OS/Arch:           linux/amd64\n Experimental:      "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n\nServer: Docker Engine - Community\n Engine:\n  Version:          "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("19.03")]),e._v(".8\n  API version:      "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.40")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("minimum version "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.12")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  Go version:       go1.12.17\n  Git commit:       afacb8b\n  Built:            Wed Mar "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("11")]),e._v(" 01:25:42 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2020")]),e._v("\n  OS/Arch:          linux/amd64\n  Experimental:     "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n containerd:\n  Version:          "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.2")]),e._v(".13\n  GitCommit:        7ad184331fa3e55e52b890ea95e65ba581ae3429\n runc:\n  Version:          "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.0")]),e._v(".0-rc10\n  GitCommit:        dc9208a3303feef5b3839f4323d9beb36df0a9dd\n docker-init:\n  Version:          "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.18")]),e._v(".0\n  GitCommit:        fec3683\n")])])]),t("h3",{attrs:{id:"_2-3-åˆå§‹åŒ–-leader-èŠ‚ç‚¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-åˆå§‹åŒ–-leader-èŠ‚ç‚¹"}},[e._v("#")]),e._v(" 2.3 åˆå§‹åŒ– leader èŠ‚ç‚¹")]),e._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[e._v("å…³äºåˆå§‹åŒ–æ—¶ç”¨åˆ°çš„ç¯å¢ƒå˜é‡")]),e._v(" "),t("ul",[t("li",[e._v("APISERVER_NAME ä¸èƒ½æ˜¯ leader çš„ hostname")]),e._v(" "),t("li",[e._v("APISERVER_NAME å¿…é¡»å…¨ä¸ºå°å†™å­—æ¯ã€æ•°å­—ã€å°æ•°ç‚¹ï¼Œä¸èƒ½åŒ…å«å‡å·")]),e._v(" "),t("li",[e._v("POD_SUBNET æ‰€ä½¿ç”¨çš„ç½‘æ®µä¸èƒ½ä¸ masterèŠ‚ç‚¹/workerèŠ‚ç‚¹ æ‰€åœ¨çš„ç½‘æ®µé‡å ã€‚è¯¥å­—æ®µçš„å–å€¼ä¸ºä¸€ä¸ª CIDR å€¼ï¼Œå¦‚æœæ‚¨å¯¹ CIDR è¿™ä¸ªæ¦‚å¿µè¿˜ä¸ç†Ÿæ‚‰ï¼Œè¯·ä»ç„¶æ‰§è¡Œ export POD_SUBNET=10.100.0.1/16 å‘½ä»¤ï¼Œä¸åšä¿®æ”¹")])])]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åªåœ¨ leader èŠ‚ç‚¹æ‰§è¡Œ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æ›¿æ¢ x.x.x.x ä¸º leader èŠ‚ç‚¹å®é™… IPï¼ˆè¯·ä½¿ç”¨å†…ç½‘ IPï¼‰")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# export å‘½ä»¤åªåœ¨å½“å‰ shell ä¼šè¯ä¸­æœ‰æ•ˆï¼Œå¼€å¯æ–°çš„ shell çª—å£åï¼Œå¦‚æœè¦ç»§ç»­å®‰è£…è¿‡ç¨‹ï¼Œè¯·é‡æ–°æ‰§è¡Œæ­¤å¤„çš„ export å‘½ä»¤")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("MASTER_IP")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("x.x.x.x   "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 192.168.83.11")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æ›¿æ¢ apiserver.demo ä¸º æ‚¨æƒ³è¦çš„ dnsName")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("APISERVER_NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("k8s.vm\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Kubernetes å®¹å™¨ç»„æ‰€åœ¨çš„ç½‘æ®µï¼Œè¯¥ç½‘æ®µå®‰è£…å®Œæˆåï¼Œç”± kubernetes åˆ›å»ºï¼Œäº‹å…ˆå¹¶ä¸å­˜åœ¨äºæ‚¨çš„ç‰©ç†ç½‘ç»œä¸­")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("POD_SUBNET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.100")]),e._v(".0.1/16\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${MASTER_IP}")]),e._v("    "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${APISERVER_NAME}")]),e._v('"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/hosts\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -sSL https://kuboard.cn/install-script/v1.18.x/init_master.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sh")]),e._v(" -s "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1.18")]),e._v(".8\n")])])]),t("h3",{attrs:{id:"_2-4-åˆå§‹åŒ–worker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-åˆå§‹åŒ–worker"}},[e._v("#")]),e._v(" 2.4 åˆå§‹åŒ–worker")]),e._v(" "),t("h4",{attrs:{id:"_2-4-1-è·å¾—-joinå‘½ä»¤å‚æ•°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-1-è·å¾—-joinå‘½ä»¤å‚æ•°"}},[e._v("#")]),e._v(" 2.4.1 è·å¾— joinå‘½ä»¤å‚æ•°")]),e._v(" "),t("p",[e._v("åœ¨ master èŠ‚ç‚¹ä¸Šæ‰§è¡Œ")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),e._v("\nkubeadm token create --print-join-command\n")])])]),t("p",[e._v("å¯è·å–kubeadm join å‘½ä»¤åŠå‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# kubeadm token create å‘½ä»¤çš„è¾“å‡º")]),e._v("\nkubeadm "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("join")]),e._v(" apiserver.demo:6443 --token mpfjma.4vjjg8flqihor4vt     --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("æœ‰æ•ˆæ—¶é—´")]),e._v(" "),t("p",[e._v("è¯¥ token çš„æœ‰æ•ˆæ—¶é—´ä¸º 2 ä¸ªå°æ—¶ï¼Œ2å°æ—¶å†…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤ token åˆå§‹åŒ–ä»»æ„æ•°é‡çš„ worker èŠ‚ç‚¹ã€‚")])]),e._v(" "),t("h4",{attrs:{id:"_2-4-2-é’ˆå¯¹æ‰€æœ‰çš„-worker-èŠ‚ç‚¹æ‰§è¡Œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-2-é’ˆå¯¹æ‰€æœ‰çš„-worker-èŠ‚ç‚¹æ‰§è¡Œ"}},[e._v("#")]),e._v(" 2.4.2 é’ˆå¯¹æ‰€æœ‰çš„ worker èŠ‚ç‚¹æ‰§è¡Œ")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åªåœ¨ worker èŠ‚ç‚¹æ‰§è¡Œ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æ›¿æ¢ x.x.x.x ä¸º master èŠ‚ç‚¹çš„å†…ç½‘ IP")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("MASTER_IP")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".83.11\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æ›¿æ¢ apiserver.demo ä¸ºåˆå§‹åŒ– master èŠ‚ç‚¹æ—¶æ‰€ä½¿ç”¨çš„ APISERVER_NAME")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("APISERVER_NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("k8s.vm\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${MASTER_IP}")]),e._v("    "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${APISERVER_NAME}")]),e._v('"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/hosts\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æ›¿æ¢ä¸º master èŠ‚ç‚¹ä¸Š kubeadm token create å‘½ä»¤çš„è¾“å‡º")]),e._v("\nkubeadm "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("join")]),e._v(" apiserver.demo:6443 --token mpfjma.4vjjg8flqihor4vt     --discovery-token-ca-cert-hash sha256:6f7a8e40a810323672de5eee6f4d19aa2dbdb38411845a1bf5dd63485c43d303\n\n")])])]),t("h3",{attrs:{id:"_2-5-æ£€æŸ¥åˆå§‹åŒ–ç»“æœ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-æ£€æŸ¥åˆå§‹åŒ–ç»“æœ"}},[e._v("#")]),e._v(" 2.5 æ£€æŸ¥åˆå§‹åŒ–ç»“æœ")]),e._v(" "),t("p",[e._v("åœ¨ master èŠ‚ç‚¹ä¸Šæ‰§è¡Œ")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ")]),e._v("\nkubectl get nodes -o wide\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("root@k8s-leader ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# kubectl get nodes -o wide")]),e._v("\nNAME          STATUS   ROLES    AGE   VERSION   INTERNAL-IP     EXTERNAL-IP   OS-IMAGE                KERNEL-VERSION              CONTAINER-RUNTIME\nk8s-leader    Ready    master   98m   v1.18.8   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".83.11   "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("        CentOS Linux "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("7")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("Core"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo.x86_64   docker://19.3.8\nk8s-worker1   Ready    "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("   23m   v1.18.8   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".83.12   "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("        CentOS Linux "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("7")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("Core"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo.x86_64   docker://19.3.8\nk8s-worker2   Ready    "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("   73m   v1.18.8   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".83.13   "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("        CentOS Linux "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("7")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("Core"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5.8")]),e._v(".3-1.el7.elrepo.x86_64   docker://19.3.8\n")])])]),t("h3",{attrs:{id:"_2-6-è®¾ç½®èŠ‚ç‚¹role"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-è®¾ç½®èŠ‚ç‚¹role"}},[e._v("#")]),e._v(" 2.6 è®¾ç½®èŠ‚ç‚¹role")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("kubectl label "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("node")]),e._v(" k8s-worker2 node-role.kubernetes.io/worker"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("worker\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);