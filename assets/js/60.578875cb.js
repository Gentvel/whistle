(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{606:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("视图（View）是一种虚拟存在的表，对于使用视图的用户来说基本上是透明的。视图并不在数据库中实际存在，行和列数据来自定义视图的查询中使用的表，并且是在使用视图时动态生成的。视图相对于普通的表的优势主要包括以下几项:")]),t._v(" "),a("ul",[a("li",[t._v("简单：使用视图的用户完全不需要关心后面对应的表的结构、关联条件和筛选条件，对用户来说已经是过滤好的复合条件的结果集。")]),t._v(" "),a("li",[t._v("安全：使用视图的用户只能访问他们被允许查询的结果集，对表的权限管理并不能限制到某个行某个列，但是通过视图就可以简单地实现。")]),t._v(" "),a("li",[t._v("数据独立：一旦视图的结构确定了，可以屏蔽表结构变化对用户的影响，源表增加列对视图没有影响；源表修改列名，则可以通过修改视图来解决，不会造成对访问者的影响。")])]),t._v(" "),a("h2",{attrs:{id:"创建-修改视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建-修改视图"}},[t._v("#")]),t._v(" 创建/修改视图")]),t._v(" "),a("p",[t._v("创建视图需要有CREATE VIEW的权限，并且对于查询涉及的列有SELECT权限。如果使用CREATE OR REPLACE或者ALTER修改视图，那么还需要该视图的DROP权限。\n创建语法为：")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--创建语法")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("OR")]),t._v(" REPALCE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ALGORATHM"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("{UNDIFINED"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("MERGE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TEMPTABLE")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFINER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("{"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("current_user")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SQL")]),t._v(" SECURITY {"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFINER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INVOKER")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VIEW")]),t._v(" view_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("column_list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" select_statement\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CASCADED")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LOCAL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHECK")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OPTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--修改语法")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALTER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALGORITHM")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("{UNDIFINED "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("MERGE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TEMPTABLE")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VIEW")]),t._v(" view_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("column_list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" select_statement\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CASCADED")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LOCAL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHECK")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OPTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[a("strong",[a("code",[t._v("OR REPLACE")])]),t._v(":表示在创建视图时会替换已有的视图")])]),t._v(" "),a("li",[a("p",[a("strong",[a("code",[t._v("ALGORATHM")])]),t._v(":视图算法（缺省ALGORITHM选项等同于ALGORITHM = UNDEFINED）\n1."),a("em",[a("strong",[t._v("UNDEFINED")])]),t._v("：MySQL将自动选择所要使用的算法（如果可能，它倾向于MERGE而不是TEMPTABLE，这是因为MERGE通常更有效，而且如果使用了临时表，视图是不可更新的。）\n2."),a("em",[a("strong",[t._v("MERGE")])]),t._v("：将视图的语句与视图定义合并起来，使得视图定义的某一部分取代语句的对应部分（每当执行的时候,先将视图的sql语句与外部查询视图的sql语句,合并在一起,最终执行；）\n3."),a("em",[a("strong",[t._v("TEMPTABLE")])]),t._v("：将视图的结果存入临时表，然后使用临时表执行语句（使用了临时表，视图是不可更新的，）")])]),t._v(" "),a("li",[a("p",[a("strong",[a("code",[t._v("DEFINER")])]),t._v("：视图的创建者或定义者（指定关键字CURRENT_USER(当前用户)和不指定该选项效果相同）")])]),t._v(" "),a("li",[a("p",[a("strong",[a("code",[t._v("SQL SECURITY")])]),t._v(":要查询一个视图，首先必须要具有对视图的select权限，如果同一个用户对于视图所访问的表没有select权限就需要指定此选项（缺省SQL SECURITY选项等同于SQL SECURITY DEFINER）\n1."),a("em",[a("strong",[t._v("SQL SECURITY DEFINER")])]),t._v("：定义(创建)视图的用户必须对视图所访问的表具有select权限，也就是说将来其他用户访问视图的时候以定义者的身份，可以查询到基表内容\n2."),a("em",[a("strong",[t._v("SQL SECURITY INVOKER")])]),t._v("：访问视图的用户必须对视图所访问的表具有select权限。")])]),t._v(" "),a("li",[a("p",[a("strong",[a("code",[t._v("WITH CHECK OPTION")])]),t._v(":对于可以执行DML操作的视图，对视图所做的DML操作的结果，不能违反视图的WHERE条件的限制。(不指定选项则默认是CASCADED)\n"),a("em",[a("strong",[t._v("CASCADED")])]),t._v("：检查所有的视图，会检查嵌套视图及其底层的视图\n"),a("em",[a("strong",[t._v("LOCAL")])]),t._v("：只检查将要更新的视图本身，嵌套视图不检查其底层的视图")])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",[t._v("MySQL视图的定义有一些限制，例如，在FROM关键字后面不能包含子查询，这和其他数据库是不同的，如果视图是从其他数据库迁移过来的，那么可能需要因此做一些改动，可以将子查询的内容先定义成一个视图，然后对该视图再创建视图就可以实现类似的功能了。")])]),t._v(" "),a("p",[t._v("视图的可更新性和视图中查询的定义有关系，以下类型的视图是不可更新的")]),t._v(" "),a("ul",[a("li",[t._v("包含以下关键字的SQL语句：聚合函数（SUM、MIN、MAX、COUNT等）、DISTINCT、GROUP BY、HAVING、UNION或者UNION ALL。")]),t._v(" "),a("li",[t._v("常量视图。")]),t._v(" "),a("li",[t._v("SELECT中包含子查询。")]),t._v(" "),a("li",[t._v("JOIN。")]),t._v(" "),a("li",[t._v("FROM一个不能更新的视图。")]),t._v(" "),a("li",[t._v("WHERE字句的子查询引用了FROM字句中的表")])])])}),[],!1,null,null,null);s.default=e.exports}}]);