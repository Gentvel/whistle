<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>【多线程】 篇三  关键字 | 林秃秃</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="有术无道，止于术；有道无术，术尚可求。">
    <link rel="preload" href="/whistle/assets/css/0.styles.27a793f2.css" as="style"><link rel="preload" href="/whistle/assets/js/app.c849928c.js" as="script"><link rel="preload" href="/whistle/assets/js/3.f6935b69.js" as="script"><link rel="preload" href="/whistle/assets/js/1.ca64ea80.js" as="script"><link rel="preload" href="/whistle/assets/js/21.0a6ce8b6.js" as="script"><link rel="prefetch" href="/whistle/assets/js/10.19865d52.js"><link rel="prefetch" href="/whistle/assets/js/100.0fdba92f.js"><link rel="prefetch" href="/whistle/assets/js/101.1412c0d5.js"><link rel="prefetch" href="/whistle/assets/js/102.0f01dd8f.js"><link rel="prefetch" href="/whistle/assets/js/103.bae8272b.js"><link rel="prefetch" href="/whistle/assets/js/104.ba1d7a63.js"><link rel="prefetch" href="/whistle/assets/js/105.88774299.js"><link rel="prefetch" href="/whistle/assets/js/106.90349fe7.js"><link rel="prefetch" href="/whistle/assets/js/107.335b7f02.js"><link rel="prefetch" href="/whistle/assets/js/108.67608ec7.js"><link rel="prefetch" href="/whistle/assets/js/109.fdcd6597.js"><link rel="prefetch" href="/whistle/assets/js/11.9a03e430.js"><link rel="prefetch" href="/whistle/assets/js/110.c61bcef2.js"><link rel="prefetch" href="/whistle/assets/js/111.accb4d01.js"><link rel="prefetch" href="/whistle/assets/js/112.392f20f1.js"><link rel="prefetch" href="/whistle/assets/js/113.3725f52d.js"><link rel="prefetch" href="/whistle/assets/js/114.4d51e46e.js"><link rel="prefetch" href="/whistle/assets/js/115.b06b4a52.js"><link rel="prefetch" href="/whistle/assets/js/116.5739ac85.js"><link rel="prefetch" href="/whistle/assets/js/117.07a928d9.js"><link rel="prefetch" href="/whistle/assets/js/118.35737cd9.js"><link rel="prefetch" href="/whistle/assets/js/119.e4460eb2.js"><link rel="prefetch" href="/whistle/assets/js/12.449405b3.js"><link rel="prefetch" href="/whistle/assets/js/120.046638c5.js"><link rel="prefetch" href="/whistle/assets/js/121.fb1caf41.js"><link rel="prefetch" href="/whistle/assets/js/122.72021ded.js"><link rel="prefetch" href="/whistle/assets/js/123.84032e47.js"><link rel="prefetch" href="/whistle/assets/js/124.9ed28712.js"><link rel="prefetch" href="/whistle/assets/js/125.eb048089.js"><link rel="prefetch" href="/whistle/assets/js/126.2960e7f7.js"><link rel="prefetch" href="/whistle/assets/js/127.e7ad2e9d.js"><link rel="prefetch" href="/whistle/assets/js/128.b3744390.js"><link rel="prefetch" href="/whistle/assets/js/129.b011d3f2.js"><link rel="prefetch" href="/whistle/assets/js/13.16a79965.js"><link rel="prefetch" href="/whistle/assets/js/130.a05d728d.js"><link rel="prefetch" href="/whistle/assets/js/131.eef6c73c.js"><link rel="prefetch" href="/whistle/assets/js/132.0387996b.js"><link rel="prefetch" href="/whistle/assets/js/14.891c2195.js"><link rel="prefetch" href="/whistle/assets/js/15.e953afa5.js"><link rel="prefetch" href="/whistle/assets/js/16.b8699525.js"><link rel="prefetch" href="/whistle/assets/js/17.b91b75f1.js"><link rel="prefetch" href="/whistle/assets/js/18.9f29e718.js"><link rel="prefetch" href="/whistle/assets/js/19.263598cc.js"><link rel="prefetch" href="/whistle/assets/js/20.770fe2d3.js"><link rel="prefetch" href="/whistle/assets/js/22.02e00977.js"><link rel="prefetch" href="/whistle/assets/js/23.6207cbb8.js"><link rel="prefetch" href="/whistle/assets/js/24.24e5a71d.js"><link rel="prefetch" href="/whistle/assets/js/25.e1e15b11.js"><link rel="prefetch" href="/whistle/assets/js/26.7d1364f8.js"><link rel="prefetch" href="/whistle/assets/js/27.86cb59bd.js"><link rel="prefetch" href="/whistle/assets/js/28.21fe08a4.js"><link rel="prefetch" href="/whistle/assets/js/29.7fefe934.js"><link rel="prefetch" href="/whistle/assets/js/30.1fca0706.js"><link rel="prefetch" href="/whistle/assets/js/31.0dd0f434.js"><link rel="prefetch" href="/whistle/assets/js/32.809fd211.js"><link rel="prefetch" href="/whistle/assets/js/33.ced660fe.js"><link rel="prefetch" href="/whistle/assets/js/34.2fe58e53.js"><link rel="prefetch" href="/whistle/assets/js/35.1c33f7cc.js"><link rel="prefetch" href="/whistle/assets/js/36.9236ac80.js"><link rel="prefetch" href="/whistle/assets/js/37.b82cf1aa.js"><link rel="prefetch" href="/whistle/assets/js/38.bad257bf.js"><link rel="prefetch" href="/whistle/assets/js/39.05285128.js"><link rel="prefetch" href="/whistle/assets/js/4.33f70e17.js"><link rel="prefetch" href="/whistle/assets/js/40.17f2c77b.js"><link rel="prefetch" href="/whistle/assets/js/41.a287741a.js"><link rel="prefetch" href="/whistle/assets/js/42.6e794082.js"><link rel="prefetch" href="/whistle/assets/js/43.8ac74e68.js"><link rel="prefetch" href="/whistle/assets/js/44.91e1fec5.js"><link rel="prefetch" href="/whistle/assets/js/45.42c52a75.js"><link rel="prefetch" href="/whistle/assets/js/46.65fcc9b8.js"><link rel="prefetch" href="/whistle/assets/js/47.4b878044.js"><link rel="prefetch" href="/whistle/assets/js/48.5c647dd0.js"><link rel="prefetch" href="/whistle/assets/js/49.46a6f0c3.js"><link rel="prefetch" href="/whistle/assets/js/5.44a242a9.js"><link rel="prefetch" href="/whistle/assets/js/50.3050ef3e.js"><link rel="prefetch" href="/whistle/assets/js/51.78a2fd5b.js"><link rel="prefetch" href="/whistle/assets/js/52.6d146ed8.js"><link rel="prefetch" href="/whistle/assets/js/53.501e8829.js"><link rel="prefetch" href="/whistle/assets/js/54.6299a871.js"><link rel="prefetch" href="/whistle/assets/js/55.31e11b60.js"><link rel="prefetch" href="/whistle/assets/js/56.084e968e.js"><link rel="prefetch" href="/whistle/assets/js/57.91968542.js"><link rel="prefetch" href="/whistle/assets/js/58.f683ed7b.js"><link rel="prefetch" href="/whistle/assets/js/59.ed4ee9cd.js"><link rel="prefetch" href="/whistle/assets/js/6.06c2faef.js"><link rel="prefetch" href="/whistle/assets/js/60.578875cb.js"><link rel="prefetch" href="/whistle/assets/js/61.761cb8df.js"><link rel="prefetch" href="/whistle/assets/js/62.3f38fad5.js"><link rel="prefetch" href="/whistle/assets/js/63.289b89c6.js"><link rel="prefetch" href="/whistle/assets/js/64.3d311a31.js"><link rel="prefetch" href="/whistle/assets/js/65.497be64f.js"><link rel="prefetch" href="/whistle/assets/js/66.91f1d53c.js"><link rel="prefetch" href="/whistle/assets/js/67.df5562a9.js"><link rel="prefetch" href="/whistle/assets/js/68.a0ef3fb8.js"><link rel="prefetch" href="/whistle/assets/js/69.f7377bde.js"><link rel="prefetch" href="/whistle/assets/js/7.65818d2e.js"><link rel="prefetch" href="/whistle/assets/js/70.e2c50de8.js"><link rel="prefetch" href="/whistle/assets/js/71.0d77b6b1.js"><link rel="prefetch" href="/whistle/assets/js/72.44c83251.js"><link rel="prefetch" href="/whistle/assets/js/73.1a7b8007.js"><link rel="prefetch" href="/whistle/assets/js/74.bc331b32.js"><link rel="prefetch" href="/whistle/assets/js/75.7628cab6.js"><link rel="prefetch" href="/whistle/assets/js/76.144a2aab.js"><link rel="prefetch" href="/whistle/assets/js/77.bd3d9092.js"><link rel="prefetch" href="/whistle/assets/js/78.6f06e89e.js"><link rel="prefetch" href="/whistle/assets/js/79.b5cc874d.js"><link rel="prefetch" href="/whistle/assets/js/8.f7c9d158.js"><link rel="prefetch" href="/whistle/assets/js/80.8725a0cf.js"><link rel="prefetch" href="/whistle/assets/js/81.bc083770.js"><link rel="prefetch" href="/whistle/assets/js/82.93c44050.js"><link rel="prefetch" href="/whistle/assets/js/83.de36a387.js"><link rel="prefetch" href="/whistle/assets/js/84.f7e48c4e.js"><link rel="prefetch" href="/whistle/assets/js/85.58ec196f.js"><link rel="prefetch" href="/whistle/assets/js/86.9dee754a.js"><link rel="prefetch" href="/whistle/assets/js/87.c3a19168.js"><link rel="prefetch" href="/whistle/assets/js/88.b0888120.js"><link rel="prefetch" href="/whistle/assets/js/89.2ac99c64.js"><link rel="prefetch" href="/whistle/assets/js/9.2a7508b2.js"><link rel="prefetch" href="/whistle/assets/js/90.49932208.js"><link rel="prefetch" href="/whistle/assets/js/91.8c2de1f6.js"><link rel="prefetch" href="/whistle/assets/js/92.1ce4cbc0.js"><link rel="prefetch" href="/whistle/assets/js/93.15b88173.js"><link rel="prefetch" href="/whistle/assets/js/94.b91ccb62.js"><link rel="prefetch" href="/whistle/assets/js/95.74ebc95e.js"><link rel="prefetch" href="/whistle/assets/js/96.b5e01145.js"><link rel="prefetch" href="/whistle/assets/js/97.c62544f3.js"><link rel="prefetch" href="/whistle/assets/js/98.ffe218d7.js"><link rel="prefetch" href="/whistle/assets/js/99.ceb46fe4.js">
    <link rel="stylesheet" href="/whistle/assets/css/0.styles.27a793f2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>林秃秃</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>林秃秃</span>
            
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/whistle/" class="home-link router-link-active"><img src="/whistle/logo.svg" alt="林秃秃" class="logo"> <span class="site-name">林秃秃</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/whistle/" class="nav-link"><i class="iconfont reco-eye"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/whistle/categories/algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  algorithm
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/数据结构/" class="nav-link"><i class="iconfont undefined"></i>
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/基础/" class="nav-link"><i class="iconfont undefined"></i>
  基础
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/MySQL/" class="nav-link"><i class="iconfont undefined"></i>
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/redis/" class="nav-link"><i class="iconfont undefined"></i>
  redis
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/操作系统/" class="nav-link"><i class="iconfont undefined"></i>
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/java/" class="nav-link"><i class="iconfont undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/多线程/" class="nav-link"><i class="iconfont undefined"></i>
  多线程
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/中间件/" class="nav-link"><i class="iconfont undefined"></i>
  中间件
</a></li></ul></div></div><div class="nav-item"><a href="/whistle/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/whistle/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-ca798c94 data-v-dad8a512><img src="/whistle/avatar.png" alt="author-avatar" class="personal-img" data-v-ca798c94> <h3 class="name" data-v-ca798c94>
    林秃秃
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>90</h3> <h6 data-v-ca798c94>文章</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>12</h3> <h6 data-v-ca798c94>标签</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><a href="/whistle/" class="nav-link"><i class="iconfont reco-eye"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/whistle/categories/algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  algorithm
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/数据结构/" class="nav-link"><i class="iconfont undefined"></i>
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/基础/" class="nav-link"><i class="iconfont undefined"></i>
  基础
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/MySQL/" class="nav-link"><i class="iconfont undefined"></i>
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/redis/" class="nav-link"><i class="iconfont undefined"></i>
  redis
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/操作系统/" class="nav-link"><i class="iconfont undefined"></i>
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/java/" class="nav-link"><i class="iconfont undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/多线程/" class="nav-link"><i class="iconfont undefined"></i>
  多线程
</a></li><li class="dropdown-item"><!----> <a href="/whistle/categories/中间件/" class="nav-link"><i class="iconfont undefined"></i>
  中间件
</a></li></ul></div></div><div class="nav-item"><a href="/whistle/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/whistle/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/whistle/foundation/" class="sidebar-heading clickable open"><span>基础</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/whistle/foundation/system/" class="sidebar-heading clickable open"><span>操作系统</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/whistle/foundation/system/runtime.html" class="sidebar-link">运行机制</a></li><li><a href="/whistle/foundation/system/systemcall.html" class="sidebar-link">系统调用</a></li><li><a href="/whistle/foundation/system/process.html" class="sidebar-link">进程</a></li><li><a href="/whistle/foundation/system/linux.html" class="sidebar-link">Linux</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/whistle/foundation/mysql/" class="sidebar-heading clickable"><span>MySQL</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/whistle/foundation/redis/" class="sidebar-heading clickable"><span>Redis</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/whistle/foundation/designpattern/" class="sidebar-link">设计模式</a></li><li><a href="/whistle/foundation/bitewise.html" class="sidebar-link">位运算</a></li><li><a href="/whistle/foundation/git.html" class="sidebar-link">Git</a></li><li><a href="/whistle/foundation/markdown.html" class="sidebar-link">Markdown</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/whistle/java/" class="sidebar-heading clickable router-link-active"><span>JAVA</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/whistle/middle/" class="sidebar-heading clickable"><span>中间件</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>【多线程】 篇三  关键字</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>林秃秃</span>
            
          <!---->
          2022
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>【多线程】 篇三  关键字</h1> <div data-v-3b7f5bdf><i class="iconfont reco-account" data-v-3b7f5bdf><span data-v-3b7f5bdf>林秃秃</span></i> <i class="iconfont reco-date" data-v-3b7f5bdf><span data-v-3b7f5bdf>2020-09-16</span></i> <!----> <i class="iconfont reco-tag tags" data-v-3b7f5bdf><span class="tag-item" data-v-3b7f5bdf>多线程</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="一、volatile"><a href="#一、volatile" class="header-anchor">#</a> 一、volatile</h2> <h3 id="_1-1-实现原理"><a href="#_1-1-实现原理" class="header-anchor">#</a> 1.1 实现原理</h3> <p><strong>volatile保证有序性原理</strong><br>
JMM通过插入内存屏障指令来禁止特定类型的重排序。<br>
java编译器在生成字节码时，在volatile变量操作前后的指令序列中插入内存屏障来特定类型的重排序</p> <p>volatile内存屏障插入策略：</p> <ul><li>在每个volatile写操作的前面插入一个StoreStore屏障。</li> <li>在每个volatile写操作的后面插入一个StoreLoad屏障。</li> <li>在每个volatile读操作的后面插入一个LoadLoad屏障。</li> <li>在每个volatile读操作的后面插入一个LoadStore屏障。</li></ul> <div class="custom-block tip"><p>Store：数据对其他处理器可见（即：刷新到内存中）
Load：让缓存中的数据失效，重新从主内存加载数据</p></div> <p><strong>volatile保证可见性原理</strong></p> <p>volatile内存屏障插入策略中有一条，“在每个volatile写操作的后面插入一个StoreLoad屏障”。</p> <p>StoreLoad屏障会生成一个Lock前缀的指令，Lock前缀的指令在多核处理器下会引发了两件事：</p> <ol><li>将当前处理器缓存行的数据写回到系统内存。</li> <li>这个写回内存的操作会使在其他CPU里缓存了该内存地址的数据无效。</li></ol> <p>volatile内存可见的写-读过程：</p> <ul><li><p>volatile修饰的变量进行写操作。</p></li> <li><p>由于编译期间JMM插入一个StoreLoad内存屏障，JVM就会向处理器发送一条Lock前缀的指令。</p></li> <li><p>Lock前缀的指令将该变量所在缓存行的数据写回到主内存中，并使其他处理器中缓存了该变量内存地址的数据失效。</p></li> <li><p>当其他线程读取volatile修饰的变量时，本地内存中的缓存失效，就会到到主内存中读取最新的数据。</p></li></ul> <h3 id="_1-2-保证可见性"><a href="#_1-2-保证可见性" class="header-anchor">#</a> 1.2 保证可见性</h3> <p>volatile保证了不同线程对volatile修饰变量进行操作时的可见性。
由原理可知，对于一个volatile变量的读，总是能看到对这个volatile变量最后的写入。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testVolatile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Running &quot;</span><span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">&quot; times&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
        flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;set flag = false&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_1-3-保证有序性"><a href="#_1-3-保证有序性" class="header-anchor">#</a> 1.3 保证有序性</h3> <p>volatile关键字能禁止指令重排序，保证了程序会严格按照代码的先后顺序执行，即保证了有序性。</p> <p>volatile的禁止重排序规则：</p> <ol><li>当第二个操作是volatile写时，不管第一个操作是什么，都不能重排序。这个规则确保volatile写之前的操作不会被编译器重排序到volatile写之后。</li> <li>当第一个操作是volatile读时，不管第二个操作是什么，都不能重排序。这个规则确保volatile读之后的操作不会被编译器重排序到volatile读之前。</li> <li>当第一个操作是volatile写，第二个操作是volatile读时，不能重排序。</li></ol> <div class="custom-block warning"><p class="custom-block-title">总结</p> <p>并发编程中，常用volatile修饰变量以保证变量的修改对其他线程可见。</p> <p>volatile可以保证可见性和有序性，不能保证原子性。</p> <p>volatile是通过插入内存屏障禁止重排序来保证可见性和有序性的。</p></div> <h2 id="二、final"><a href="#二、final" class="header-anchor">#</a> 二、final</h2> <h3 id="_2-1-final变量"><a href="#_2-1-final变量" class="header-anchor">#</a> 2.1 final变量</h3> <p>只能被赋值一次，赋值后值不再改变。（final要求地址值不能改变）
当final修饰一个基本数据类型时，表示该基本数据类型的值一旦在初始化后便不能发生变化；<br>
如果final修饰一个引用类型时，则在对其初始化之后便不能再让其指向其他对象了，但该引用所指向的对象的内容是可以发生变化的。
本质上是一回事，因为引用的值是一个地址，final要求地址值不发生变化。
当final修饰一个基本数据类型时，表示该基本数据类型的值一旦在初始化后便不能发生变化；如果final修饰一个引用类型时，则在对其初始化之后便不能再让其指向其他对象了，但<strong>该引用所指向的对象的内容是可以发生变化的</strong>。本质上是一回事，因为引用的值是一个地址，final要求地址值不发生变化。
final成员变量：两种初始化方式，一种是在变量声明的时候初始化；第二种是在声明变量的时候不赋初值，但是要在这个变量所在的类的所有的构造函数中对这个变量赋初值。</p> <h3 id="_2-2-final方法"><a href="#_2-2-final方法" class="header-anchor">#</a> 2.2 final方法</h3> <p>final修饰的方法在编译阶段被静态绑定(static binding)，不能被重写。</p> <p>final方法比非final方法要快，因为在编译的时候已经静态绑定了，不需要在运行时再动态绑定。（注：类的private方法会隐式地被指定为final方法）</p> <h3 id="_2-3-final类"><a href="#_2-3-final类" class="header-anchor">#</a> 2.3 final类</h3> <p>final修饰的类不能被继承。</p> <p>final类中的成员变量可以根据需要设为final，但是要注意final类中的所有成员方法都会被隐式地指定为final方法。</p> <p>在使用final修饰类的时候，要注意谨慎选择，除非这个类真的在以后不会用来继承或者出于安全的考虑，尽量不要将类设计为final类。</p> <div class="custom-block tip"><p class="custom-block-title">关于final的几个重要知识点</p> <p>final关键字可以提高性能，JVM和Java应用都会缓存final变量，JVM会对方法、变量及类进行优化。<br>
在匿名类中所有变量都必须是final变量。<br>
接口中声明的所有变量本身是final的。<br>
final和abstract这两个关键字是反相关的，final类就不可能是abstract的。<br>
按照Java代码惯例，final变量就是常量，而且通常常量名要大写。<br>
final变量可以安全的在多线程环境下进行共享，而不需要额外的同步开销。</p></div> <h3 id="_2-4-写final域"><a href="#_2-4-写final域" class="header-anchor">#</a> 2.4 写final域</h3> <p>在构造函数内对一个final域的写入，与随后把这个被构造对象的引用赋值给一个引用变量，这两个操作之间不能重排序。</p> <p>编译器会在final域的写之后，插入一个StoreStore屏障，这个屏障可以禁止处理器把final域的写重排序到构造函数之外。</p> <div class="custom-block tip"><p>解释：保证先写入对象的final变量，后调用该对象引用。</p></div> <h3 id="_2-5-读final域"><a href="#_2-5-读final域" class="header-anchor">#</a> 2.5 读final域</h3> <p>初次读一个包含final域的对象的引用，与随后初次读这个final域，这两个操作之间不能重排序。</p> <p>编译器会在读final域操作的前面插入一个LoadLoad屏障，这个屏障可以禁止读对象引用和读该对象final域重排序。</p> <div class="custom-block tip"><p>解释：先读对象的引用，后读该对象的final变量。</p></div> <h3 id="_2-6-final域为引用类型"><a href="#_2-6-final域为引用类型" class="header-anchor">#</a> 2.6 final域为引用类型</h3> <p>对于引用类型，写final域的重排序规则对编译器和处理器增加了如下约束：在构造函数内对一个final引用的对象的成员域的写入，与随后在构造函数外把这个被构造对象的引用赋值给一个引用变量，这两个操作之间不能重排序。</p> <div class="custom-block tip"><p class="custom-block-title">解释</p> <p>注意是增加了一条约束，所以以上两条约束都还生效。<br>
保证先写入对象的final变量的成员变量，后调用该对象引用。</p></div> <div class="custom-block warning"><p class="custom-block-title">总结</p> <p>final基础应用</p> <ul><li><p>final修饰的变量地址值不能改变。</p></li> <li><p>final修饰的方法不能被重写。</p></li> <li><p>final修饰的类不能被继承。</p></li></ul> <p>并发编程中final可以禁止特定的重排序。</p> <ul><li><p>final保证先写入对象的final变量，后调用该对象引用。</p></li> <li><p>final保证先读对象的引用，后读该对象的final变量。</p></li> <li><p>final保证先写入对象的final变量的成员变量，后调用该对象引用。</p></li></ul></div> <h2 id="三、synchronized"><a href="#三、synchronized" class="header-anchor">#</a> 三、synchronized</h2> <h3 id="_3-1-线程安全问题"><a href="#_3-1-线程安全问题" class="header-anchor">#</a> 3.1 线程安全问题</h3> <p>并发编程中，当多个线程同时访问同一个资源的时候，就会存在线程安全问题。</p> <p>由于每个线程执行的过程是不可控的，所以很可能导致最终的结果与实际期望的结果相违背或者直接导致程序出错。</p> <div class="custom-block tip"><p>基本上所有的并发模式在解决线程安全问题时，都采用“序列化访问临界资源”的方案，即在同一时刻，只能有一个线程访问临界资源，也称作同步互斥访问。<br>
通常来说，是在访问临界资源的代码前面加上一个锁，当访问完临界资源后释放锁，让其他线程继续访问。<br>
在Java中，提供了两种方式来实现同步互斥访问：synchronized和Lock。</p></div> <p>Java中用synchronized标记同步块。</p> <ul><li>同步块在Java中是同步在某个对象上（监视器对象）。</li> <li>所有同步在一个对象上的同步块在同一时间只能被一个线程进入并执行操作。</li> <li>所有其他等待进入该同步块的线程将被阻塞，直到执行该同步块中的线程退出。</li></ul> <h3 id="_3-2-synchronized用法"><a href="#_3-2-synchronized用法" class="header-anchor">#</a> 3.2 synchronized用法</h3> <ul><li><p>普通同步方法，锁是当前实例对象</p></li> <li><p>静态同步方法，锁是当前类的class对象</p></li> <li><p>同步方法块，锁是括号里面的对象</p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code>publicclass <span class="token class-name">MyClass</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> count<span class="token punctuation">;</span>
   
    <span class="token comment">// 1.实例方法</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>
        count <span class="token operator">+=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   
    <span class="token comment">// 2.实例方法中的同步块 (等价于1)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            count <span class="token operator">+=</span> value<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
   
    <span class="token comment">// 3.静态方法</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>intvalue<span class="token punctuation">)</span><span class="token punctuation">{</span>
         count <span class="token operator">+=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   
    <span class="token comment">// 4.静态方法中的同步块 (等价于3)</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">MyClass</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            count <span class="token operator">+=</span> value<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如下代码，利用javap工具查看生成的class文件信息来分析Synchronize的实现。</p> <p>代码：</p> <div class="language-java extra-class"><pre class="language-java"><code>publicclass <span class="token keyword">synchronized</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token comment">// 同步代码块</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>synchronizedTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;HelloWorld&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 同步方法</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">doSth2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;HelloWorld&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用javap对class文件进行反编译后结果：</p> <p>javap命令：
<code>D:\install\java\jdk8\bin\javap.exe -v .\synchronizedTest.class</code></p> <p>同步方法块：</p> <center><p><img src="/whistle/assets/img/block.260db9a0.png" alt="see"></p></center> <p>同步方法：</p> <center><p><img src="/whistle/assets/img/method.cb3e1fac.png" alt="see"></p></center> <p>从反编译后的结果中可以看到：对于同步方法，JVM采用ACC_synchronized标记符来实现同步。对于同步代码块。JVM采用monitorenter、monitorexit两个指令来实现同步。</p> <h3 id="_3-3-同步代码块"><a href="#_3-3-同步代码块" class="header-anchor">#</a> 3.3 同步代码块</h3> <p>JVM采用monitorenter、monitorexit两个指令来实现同步。
大致内容如下：</p> <ul><li><p>可以把执行monitorenter指令理解为加锁，执行monitorexit理解为释放锁。</p></li> <li><p>每个对象维护着一个记录着被锁次数的计数器。</p></li> <li><p>未被锁定的对象的该计数器为0，当一个线程获得锁（执行monitorenter）后，该计数器自增变为1，当同一个线程再次获得该对象的锁的时候，计数器再次自增。当同一个线程释放锁（执行monitorexit指令）的时候，计数器再自减。</p></li> <li><p>当计数器为0的时候。锁将被释放，其他线程便可以获得锁。</p></li></ul> <h3 id="_3-4-同步方法"><a href="#_3-4-同步方法" class="header-anchor">#</a> 3.4 同步方法</h3> <p>JVM采用ACC_synchronized标记符来实现同步。
大致内容如下：</p> <ul><li><p>方法级的同步是隐式的。同步方法的常量池中会有一个ACC_synchronized标志。</p></li> <li><p>当某个线程要访问某个方法的时候，会检查是否有ACC_synchronized，如果有设置，则需要先获得监视器锁（monitor），然后开始执行方法，方法执行之后再释放监视器锁。这时如果其他线程来请求执行方法，会因为无法获得监视器锁而被阻断住。</p></li> <li><p>值得注意的是，如果在方法执行过程中，发生了异常，并且方法内部并没有处理该异常，那么在异常被抛到方法外面之前监视器锁会被自动释放。</p></li></ul> <h3 id="_3-5-monitor"><a href="#_3-5-monitor" class="header-anchor">#</a> 3.5 Monitor</h3> <p>无论是同步方法还是同步代码块都是基于监视器Monitor实现的。</p> <h4 id="monitor是什么？"><a href="#monitor是什么？" class="header-anchor">#</a> Monitor是什么？</h4> <p>所有的Java对象是天生的Monitor，每一个Java对象都有成为Monitor的潜质，因为在Java的设计中，每一个Java对象自打娘胎里出来就带了一把看不见的锁，它叫做内部锁或者Monitor锁。</p> <p>每个对象都存在着一个Monitor与之关联，对象与其Monitor之间的关系有存在多种实现方式，如Monitor可以与对象一起创建销毁。</p> <h4 id="moniter如何实现线程的同步？"><a href="#moniter如何实现线程的同步？" class="header-anchor">#</a> Moniter如何实现线程的同步？</h4> <p>在Java虚拟机(HotSpot)中，monitor是由ObjectMonitor实现的（位于HotSpot虚拟机源码ObjectMonitor.hpp文件，C++实现的）。</p> <p>ObjectMonitor中有几个关键属性：</p> <ul><li>_owner：指向持有ObjectMonitor对象的线程</li> <li>_WaitSet：存放处于wait状态的线程队列</li> <li>_EntryList：存放处于等待锁block状态的线程队列</li> <li>_recursions：锁的重入次数</li> <li>_count：用来记录该线程获取锁的次数</li></ul> <center><p><img src="data:image/png;base64,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" alt="see"></p></center> <h3 id="_3-6解决三大问题"><a href="#_3-6解决三大问题" class="header-anchor">#</a> 3.6解决三大问题</h3> <h4 id="_3-6-1-保证原子性"><a href="#_3-6-1-保证原子性" class="header-anchor">#</a> 3.6.1 保证原子性</h4> <p>在并发编程中的原子性：一段代码，或者一个变量的操作，在一个线程没有执行完之前，不能被其他线程执行。</p> <p>synchronized修饰的代码在同一时间只能被一个线程访问，在锁未释放之前，无法被其他线程访问到。</p> <p>即使在执行过程中，CPU时间片用完，线程放弃了CPU，但并没有进行解锁。而由于synchronized的锁是可重入的，下一个时间片还是只能被他自己获取到，还是会由同一个线程继续执行代码，直到所有代码执行完。从而保证synchronized修饰的代码块在同一时间只能被一个线程访问。</p> <h4 id="_3-6-2-保证有序性"><a href="#_3-6-2-保证有序性" class="header-anchor">#</a> 3.6.2 保证有序性</h4> <p>如果在本线程内观察，所有操作都是天然有序的。
——《深入理解Java虚拟机》</p> <p>单线程重排序要遵守as-if-serial语义，不管怎么重排序，单线程程序的执行结果都不能被改变。因为不会改变执行结果，所以无须关心这种重排的干扰，可以认为单线程程序是按照顺序执行的。</p> <p>synchronized修饰的代码，同一时间只能被同一线程访问。那么也就是单线程执行的。所以，可以保证其有序性。</p> <h4 id="_3-6-3-保证可见性"><a href="#_3-6-3-保证可见性" class="header-anchor">#</a> 3.6.3 保证可见性</h4> <p>加锁的含义不仅仅局限于互斥行为，还包括可见性。
——《Java并发编程实战》</p> <p>JMM关于synchronized的两条语义规定保证了可见性：</p> <p>线程解锁前，必须把共享变量的最新值刷新到主内存中。</p> <p>线程加锁前，将清空工作内存中共享变量的值，从而使用共享变量时需要从主内存中重新读取最新的值。</p> <div class="custom-block warning"><p class="custom-block-title">总结</p> <p>多并发编程中通过同步互斥访问临界资源来解决线程安全问题，Java中常用synchronized标记同步块达到加锁的目的。</p> <p>synchronized用法有两种，修饰方法和修饰同步代码块。</p> <p>synchronized的实现原理：每一个Java对象都会关联一个Monitor，通过Monitor对线程的操作实现synchronized对象锁。</p> <p>并发编程中synchronized可以保证原子性、可见性、有序性。</p></div></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">最近更新: </span> <span class="time">11/8/2022, 7:16:33 AM</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/whistle/assets/js/app.c849928c.js" defer></script><script src="/whistle/assets/js/3.f6935b69.js" defer></script><script src="/whistle/assets/js/1.ca64ea80.js" defer></script><script src="/whistle/assets/js/21.0a6ce8b6.js" defer></script>
  </body>
</html>
